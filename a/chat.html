<style>*{font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;}.c,b{font-family:cursive;}</style>
<h2 class="c">Chatroom</h2>
<p>currently named <b id="x"></b></p>
<div id="chatBox">
</div>
<br>
<input name="msg" placeholder="Say something..." autocomplete="off" >
<button onclick="send()">Send</button>
<iframe name="hiddenFrame" style="display:none;"></iframe>
<script>
let name="";function yay(){name=prompt("Enter your name").substr(19);if(name.trim()===""||name===false){yay()}document.getElementById("x").innerText=name};yay();
function escapeHTML(str){
    var p = document.createElement("p");
    p.appendChild(document.createTextNode(str));
    return p.innerHTML;
}
async function ref() {
    const res = await fetch("https://cheese1995.zya.me/t/txt.php");
    const data = await res.json();
    const msgs = data.record.messages || [];
    const chatBox = document.getElementById("chatBox");
    chatBox.innerHTML = msgs.slice(-20).map(m => `<b>${escapeHTML(m.name)}:</b> ${escapeHTML(m.text)}`).join("<br>");
    chatBox.scrollTop = chatBox.scrollHeight;
}
async function send() {
    const text = document.getElementById("msg").value;
    if(text.trim()==="") return;
    await fetch("https://cheese1995.zya.me/t/send.php?name="+name+"&msg="+text);
    document.getElementById("msg").value = "";
    ref();
}
setInterval(ref, 1000);
</script>
